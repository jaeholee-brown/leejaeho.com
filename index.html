<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JAEHO</title>
    <style>
        :root {
            /* LIGHT MODE PALETTE */
            --bg-color: #ffffff;
            /* Text transparency allows grain to bleed through */
            --text-color: rgba(0, 0, 0, 0.85);
            --border-color: #bbbbbb; /* Slightly darker grey for better definition */
            
            /* COLORS */
            --green: #538d4e; 
            --yellow: #c9b458;
            --grey: #787c7e;
            
            --font-stack: 'Courier New', Courier, monospace;
        }

        body {
            background-color: #e0e0e0;
            color: var(--text-color);
            font-family: var(--font-stack);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        #screen-stack {
            position: relative;
            display: inline-block;
        }

        /* Screen Container */
        #outer-screen {
            background-color: var(--bg-color);
            padding: 30px;
            border: 4px solid #999;
            border-radius: 4px;
            position: relative;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.15);
            overflow: hidden; 
        }

        /* GRAIN + GRID OVERLAY */
        #outer-screen::after {
            content: "";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            z-index: 100;
            pointer-events: none;
            opacity: 0.65; 

            background-image: 
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='3' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.2'/%3E%3C/svg%3E"),
                linear-gradient(rgba(0, 0, 0, 0.2) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 0, 0, 0.2) 1px, transparent 1px);
            background-size: 150px 150px, 2px 2px, 2px 2px;
        }

        #game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative; 
        }

        #board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 4px;
            width: 240px;
            height: 288px;
        }

        .tile {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.6rem;
            font-weight: bold;
            text-transform: uppercase;
            box-sizing: border-box;
            user-select: none;
            color: var(--text-color);
            
            /* STRUCTURAL GRID LINES: FIXED COLOR */
            border: 2px solid var(--border-color);
            
            /* Only background and transform animate */
            transition: transform 0.1s, background-color 0.1s;
            
            /* BLUR for low-res feel */
            filter: blur(0.65px);
        }

        /* --- FLASH EFFECT --- */
        .tile.flash {
            background-color: #ffffff !important;
            color: transparent !important; /* Hide text during flash */
            /* KEY CHANGE: Border stays distinct grey, does not turn white */
            border-color: var(--border-color) !important; 
            transition: none; 
        }

        /* State Styles (Game Loop) 
           Note: We no longer change border-color here. 
           The border remains the "physical" grid layer. */

        .tile[data-state="active"] {
            /* Active state border darkening is optional, removed here for consistency */
            animation: pop 0.1s;
        }
        .tile[data-state="correct"] {
            background-color: var(--green); 
            color: rgba(255, 255, 255, 0.9);
        }
        .tile[data-state="present"] {
            background-color: var(--yellow); 
            color: rgba(255, 255, 255, 0.9);
        }
        .tile[data-state="absent"] {
            background-color: var(--grey); 
            color: rgba(255, 255, 255, 0.9);
        }

        /* Skip Button */
        #skip-btn {
            position: absolute;
            top: calc(100% + 4px);
            right: 0;
            background: none;
            border: none;
            font-family: var(--font-stack);
            font-size: 0.9rem;
            color: var(--grey);
            cursor: pointer;
            padding: 5px;
            z-index: 101;
            filter: blur(0.4px);
        }
        #skip-btn:hover {
            color: var(--text-color);
            text-decoration: underline;
        }

        /* Menu Mode Styles */
        .menu-row-link { cursor: pointer; }
        .menu-row-link:hover .tile { filter: brightness(0.9) blur(0.65px); }
        
        /* Menu Specific Colors */
        /* Again, borders remain fixed grey to simulate grid overlay */
        .tile.menu-correct { 
            background-color: var(--green); 
            color: rgba(255, 255, 255, 0.9); 
        }
        .tile.menu-present { 
            background-color: var(--yellow); 
            color: rgba(255, 255, 255, 0.9); 
        }
        .tile.menu-absent { 
            background-color: var(--grey); 
            color: rgba(255, 255, 255, 0.9); 
        }
        .tile.menu-empty { 
            background-color: var(--bg-color); 
        }


        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        #keyboard-trap {
            position: absolute;
            opacity: 0;
            top: -1000px;
        }
    </style>
</head>
<body>

    <div id="screen-stack">
        <div id="outer-screen">
            <div id="game-container">
                <div id="board"></div>
            </div>
        </div>
        <button id="skip-btn">SKIP >></button>
    </div>
    
    <input type="text" id="keyboard-trap">

    <script>
        const WORD_LENGTH = 5;
        const ROWS = 6;
        const TARGET_WORD = "JAEHO";
        
        const board = document.getElementById('board');
        const keyboardTrap = document.getElementById('keyboard-trap');
        const skipBtn = document.getElementById('skip-btn');
        
        let currentRow = 0;
        let currentTile = 0;
        let isGameOver = false;
        let guesses = Array(ROWS).fill().map(() => Array(WORD_LENGTH).fill(""));

        function initBoard() {
            board.innerHTML = '';
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < WORD_LENGTH; c++) {
                    const tile = document.createElement('div');
                    tile.id = `tile-${r}-${c}`;
                    tile.classList.add('tile');
                    board.appendChild(tile);
                }
            }
        }

        initBoard();

        // Event Listeners
        document.addEventListener('keydown', handleKeydown);
        document.addEventListener('click', () => keyboardTrap.focus());
        skipBtn.addEventListener('click', () => {
             if (!isGameOver) triggerFlashAndMenu();
        });

        function handleKeydown(e) {
            if (isGameOver) return;
            const key = e.key;
            if (key === 'Enter') checkGuess();
            else if (key === 'Backspace') deleteLetter();
            else if (/^[a-zA-Z]$/.test(key)) addLetter(key.toUpperCase());
        }

        function addLetter(letter) {
            if (currentTile < WORD_LENGTH && currentRow < ROWS) {
                const tile = document.getElementById(`tile-${currentRow}-${currentTile}`);
                tile.textContent = letter;
                tile.setAttribute('data-state', 'active');
                guesses[currentRow][currentTile] = letter;
                currentTile++;
            }
        }

        function deleteLetter() {
            if (currentTile > 0) {
                currentTile--;
                const tile = document.getElementById(`tile-${currentRow}-${currentTile}`);
                tile.textContent = '';
                tile.removeAttribute('data-state');
                guesses[currentRow][currentTile] = '';
            }
        }

        function checkGuess() {
            if (currentTile !== WORD_LENGTH) return;

            const guess = guesses[currentRow].join("");
            
            for (let i = 0; i < WORD_LENGTH; i++) {
                const tile = document.getElementById(`tile-${currentRow}-${i}`);
                const letter = guesses[currentRow][i];
                setTimeout(() => {
                    if (letter === TARGET_WORD[i]) tile.setAttribute('data-state', 'correct');
                    else if (TARGET_WORD.includes(letter)) tile.setAttribute('data-state', 'present');
                    else tile.setAttribute('data-state', 'absent');
                }, i * 100);
            }

            setTimeout(() => {
                if (guess === TARGET_WORD || currentRow >= ROWS - 1) {
                    triggerFlashAndMenu();
                } else {
                    currentRow++;
                    currentTile = 0;
                }
            }, 500);
        }

        // --- FLASH & TRANSITION LOGIC ---

        function triggerFlashAndMenu() {
            isGameOver = true;
            skipBtn.style.display = 'none';

            // Delay for last wordle reveal animation, then flash
            setTimeout(() => {
                // Flash Phase: Turn all current tiles white
                const allTiles = document.querySelectorAll('.tile');
                allTiles.forEach(tile => tile.classList.add('flash'));

                // After short flash, wipe and render menu
                setTimeout(() => {
                    transformToMenu();
                }, 400); // Flash duration

            }, 800);
        }
        
        function transformToMenu() {
            board.innerHTML = ''; 

            const menuData = [
                { text: "JAEHO", type: "header", link: null },
                { text: "     ", type: "spacer", link: null }, 
                { text: "ABOUT", type: "link", link: "https://leejaeho.com/about" },
                { text: "NOTES", type: "link", link: "https://leejaeho.com/notes" },
                { text: "CV   ", type: "link", link: "https://leejaeho.com/cv" },
                { text: "     ", type: "spacer", link: null } 
            ];

            menuData.forEach((rowInfo, rIndex) => {
                const rowDiv = document.createElement('div');
                rowDiv.style.display = 'contents';
                if(rowInfo.type === 'link') rowDiv.classList.add('menu-row-link');

                for (let c = 0; c < WORD_LENGTH; c++) {
                    const char = rowInfo.text[c];
                    const tile = document.createElement('div');
                    tile.classList.add('tile');
                    tile.textContent = char.trim();

                    if (rowInfo.type === 'header') {
                        // The answer is always green
                        tile.classList.add('menu-correct');
                    } 
                    else if (char === " ") {
                        // Spaces are empty (White)
                        tile.classList.add('menu-empty');
                    } 
                    else {
                        // WORDLE LOGIC FOR MENU ITEMS
                        // 1. Is it in the correct spot? (Green)
                        if (char === TARGET_WORD[c]) {
                            tile.classList.add('menu-correct');
                        } 
                        // 2. Is it in the word at all? (Yellow)
                        else if (TARGET_WORD.includes(char)) {
                            tile.classList.add('menu-present');
                        } 
                        // 3. Not in word (Grey)
                        else {
                            tile.classList.add('menu-absent');
                        }
                    }

                    rowDiv.appendChild(tile);
                }
                board.appendChild(rowDiv);

                 if (rowInfo.type === 'link') {
                        rowDiv.onclick = () => {
                             window.location.href = rowInfo.link;
                        };
                    }
            });
        }
    </script>
</body>
</html>
